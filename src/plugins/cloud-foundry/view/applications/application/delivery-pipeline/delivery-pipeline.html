<delivery-pipeline-status hce="applicationDeliveryPipelineCtrl.hceServices" setup="applicationDeliveryPipelineCtrl.setupPipeline" pipeline="applicationDeliveryPipelineCtrl.model.application.pipeline"></delivery-pipeline-status>
<div ng-if="applicationDeliveryPipelineCtrl.busy" class="message-box message-box-no-bg">
  <bounce-spinner classes="bounce-spinner-sm"></bounce-spinner>
</div>
<div ng-if="applicationDeliveryPipelineCtrl.isDeleting" class="message-box message-box-no-bg">
  <bounce-spinner classes="bounce-spinner-sm"></bounce-spinner>
</div>
<div ng-if="!applicationDeliveryPipelineCtrl.isDeleting && applicationDeliveryPipelineCtrl.project">
  <div class="card panel panel-default">
    <div class="panel-heading action-header">
      <span translate>Summary</span>
      <a class="btn btn-link" ng-click="applicationDeliveryPipelineCtrl.deletePipeline()">
        <i class="helion-icon helion-icon-Right_Arrow"></i>
        <span translate>Delete Pipeline</span>
      </a>
    </div>
    <div ng-if="applicationDeliveryPipelineCtrl.deleteError" class="alert alert-danger">
      <p translate>
        An error occurred deleting this pipeline. Please try again. If this error persists, please contact the administrator.
      </p>
    </div>
    <div class="panel-body delivery-pipeline-summary">
      <div class="row">
        <dl class="dl-horizontal col-md-6">
          <dt translate>source</dt>
          <dd>
            {{ applicationDeliveryPipelineCtrl.project.repo.vcs | uppercase}}
          </dd>
          <dt translate>repo</dt>
          <dd>
            {{ applicationDeliveryPipelineCtrl.project.repo.name }}
          </dd>
          <dt translate>branch</dt>
          <dd>
            {{ applicationDeliveryPipelineCtrl.project.repo.branch }}
          </dd>
          <dt translate>build container</dt>
          <dd>
            {{ applicationDeliveryPipelineCtrl.project.buildContainer.build_container_label }}
          </dd>
        </dl>
        <dl class="dl-horizontal col-md-6">
          <dt translate>hce endpoint url</dt>
          <dd>
            {{ applicationDeliveryPipelineCtrl.hceCnsi.api_endpoint.Scheme }}://{{ applicationDeliveryPipelineCtrl.hceCnsi.api_endpoint.Host }}{{ applicationDeliveryPipelineCtrl.hceCnsi.api_endpoint.Path }}
          </dd>
        </dl>
      </div>
    </div>
  </div>

  <div id="notification-targets">
    <div class="action-header">
      <span translate>Notification Targets</span>
      <button class="btn btn-link" ng-click="applicationDeliveryPipelineCtrl.addNotificationTarget()">
        <i class="helion-icon helion-icon-Right_Arrow"></i>
        <span translate>Add Target</span>
      </button>
    </div>
    <div class="panel panel-default">
      <div class="panel-body" ng-if="!applicationDeliveryPipelineCtrl.notificationTargets.length">
        <span translate>You have no notification targets.</span>
      </div>
      <table ng-if="applicationDeliveryPipelineCtrl.notificationTargets.length"
        class="table table-actionable">
        <thead>
          <tr>
            <th translate>Name</th>
            <th translate>Type</th>
            <th translate>Location</th>
            <th translate>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="target in applicationDeliveryPipelineCtrl.notificationTargets">
            <td>{{ target.name }}</td>
            <td>{{ target.type }}</td>
            <td>{{ target.location }}</td>
            <td>
              <actions-menu actions="applicationDeliveryPipelineCtrl.notificationTargetActions"
                action-target="target" menu-icon="helion-icon helion-icon-More"></actions-menu>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="post-deploy-actions">
    <div class="action-header">
      <span translate>Post Deploy Actions</span>
      <button
        class="btn btn-link"
        ng-click="applicationDeliveryPipelineCtrl.addPostDeployAction()">
        <i class="helion-icon helion-icon-Right_Arrow"></i>
        <span translate>Add Action</span>
      </button>
    </div>
    <div class="panel panel-default">
      <div class="panel-body" ng-if="!applicationDeliveryPipelineCtrl.postDeployActions.length">
        <span translate>You have no post deploy actions.</span>
      </div>
      <table ng-if="applicationDeliveryPipelineCtrl.postDeployActions.length"
        class="table table-actionable">
        <thead>
        <tr>
          <th translate>Name</th>
          <th translate>Type</th>
          <th translate>Created</th>
          <th translate>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="postDeployAction in applicationDeliveryPipelineCtrl.postDeployActions">
          <td>{{ postDeployAction.task_label }}</td>
          <td>{{ postDeployAction.task_type }}</td>
          <td>{{ postDeployAction.created }}</td>
          <td>
            <actions-menu actions="applicationDeliveryPipelineCtrl.postDeployActionActions"
                          action-target="postDeployAction" menu-icon="helion-icon helion-icon-More"></actions-menu>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="container-registries">
    <div class="action-header">
      <span translate>Container Registries</span>
      <button class="btn btn-link">
        <i class="helion-icon helion-icon-Right_Arrow"></i>
        <span translate>Add Container Registry</span>
      </button>
    </div>
    <div class="panel panel-default">
      <div class="panel-body" ng-if="!applicationDeliveryPipelineCtrl.hceModel.data.imageRegistries.length">
        <span translate>You have no container registries.</span>
      </div>
      <table ng-if="applicationDeliveryPipelineCtrl.hceModel.data.imageRegistries.length"
        class="table table-actionable">
        <thead>
          <tr>
            <th translate>Registry Name</th>
            <th translate>Designated</th>
            <th translate>URL</th>
            <th translate>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="registry in applicationDeliveryPipelineCtrl.hceModel.data.imageRegistries">
            <td>{{ registry.registry_label }}</td>
            <td></td>
            <td>{{ registry.registry_url }}</td>
            <td>
              <actions-menu actions="applicationDeliveryPipelineCtrl.containerRegistryActions"
                action-target="registry" menu-icon="helion-icon helion-icon-More"></actions-menu>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
